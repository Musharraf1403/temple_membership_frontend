<div class="container">
  <p-toast />

  <div *ngIf="loading" class="flex justify-content-center align-items-center" style="height: 400px;">
    <p-progressSpinner />
  </div>

  <div *ngIf="error && !loading" class="card p-4 text-center">
    <div class="mb-3">
      <i class="pi pi-exclamation-circle text-red-500" style="font-size: 3rem;"></i>
    </div>
    <h2 class="text-red-500">Error</h2>
    <p>{{ error }}</p>
    <p-button label="Redirecting to Home..." severity="secondary" [disabled]="true" />
  </div>

  <!-- Registration Success -->
  <div *ngIf="sessionDetails && !loading" class="card p-5">
    <!-- Success Header -->
    <div class="text-center mb-5">
      <i class="pi pi-check-circle text-green-500" style="font-size: 4rem;"></i>
      <h1 class="mt-3 mb-2">Payment Successful!</h1>
      <p class="text-gray-600">Thank you for your registration</p>
    </div>

    <!-- Email Notification Message -->
    <div class="bg-blue-50 border-1 border-blue-200 border-round p-4 mb-5">
      <div class="flex gap-3">
        <i class="pi pi-envelope text-blue-600" style="font-size: 1.5rem;"></i>
        <div>
          <h4 class="mt-0 mb-2 text-blue-700">Confirmation Email Sent</h4>
          <p class="m-0 text-blue-600">
            We've sent a confirmation email with your registration details to <strong>{{ sessionDetails.member?.email }}</strong>. 
            Please check your email (and spam folder) for the details.
          </p>
        </div>
      </div>
    </div>

    <!-- Registration Details -->
    <div class="grid mb-5">
      <div class="col-12 md:col-6">
        <div class="surface-section p-4 border-round">
          <h3 class="mb-3">Payment Details</h3>
          <div class="mb-3">
            <span class="text-gray-600 font-semibold">Transaction ID:</span>
            <p class="mt-1">{{ sessionDetails.paymentIntent }}</p>
          </div>
          <div class="mb-3">
            <span class="text-gray-600 font-semibold">Amount:</span>
            <p class="mt-1 text-xl font-bold text-green-600">Â£{{ sessionDetails.amount }}</p>
          </div>
          <div class="mb-3">
            <span class="text-gray-600 font-semibold">Status:</span>
            <p class="mt-1">{{ sessionDetails.paymentStatus || 'Completed' }}</p>
          </div>
        </div>
      </div>

      <!-- Member Details -->
      <div class="col-12 md:col-6">
        <div class="surface-section p-4 border-round">
          <h3 class="mb-3">Your Information</h3>
          <div class="mb-3">
            <span class="text-gray-600 font-semibold">Name:</span>
            <p class="mt-1">{{ sessionDetails.member?.name }}</p>
          </div>
          <div class="mb-3">
            <span class="text-gray-600 font-semibold">Email:</span>
            <p class="mt-1">{{ sessionDetails.member?.email }}</p>
          </div>
          <div class="mb-3">
            <span class="text-gray-600 font-semibold">Phone:</span>
            <p class="mt-1">{{ sessionDetails.member?.phone }}</p>
          </div>
        </div>
      </div>
    </div>

    <!-- Action Buttons -->
    <div class="flex gap-3 justify-content-center flex-wrap">
      <p-button
        label="Go to Home"
        icon="pi pi-home"
        severity="success"
        (onClick)="goHome()"
      />
    </div>
  </div>
</div>
